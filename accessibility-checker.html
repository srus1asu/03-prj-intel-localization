<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Accessibility Checker - Intel Timeline</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
  <style>
    body {
      padding: 20px;
      background: #f5f5f5;
    }
    .checker-container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .check-item {
      padding: 12px;
      margin: 8px 0;
      border-left: 4px solid #ddd;
      background: #f8f9fa;
      border-radius: 4px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .check-item.pass {
      border-left-color: #28a745;
      background: #d4edda;
    }
    .check-item.fail {
      border-left-color: #dc3545;
      background: #f8d7da;
    }
    .check-item.warning {
      border-left-color: #ffc107;
      background: #fff3cd;
    }
    .icon-check {
      font-size: 1.5rem;
      color: #28a745;
    }
    .icon-fail {
      font-size: 1.5rem;
      color: #dc3545;
    }
    .icon-warning {
      font-size: 1.5rem;
      color: #ffc107;
    }
    .summary {
      display: flex;
      gap: 20px;
      margin: 20px 0;
    }
    .summary-card {
      flex: 1;
      padding: 20px;
      border-radius: 8px;
      text-align: center;
    }
    .summary-card.pass {
      background: #d4edda;
      border: 2px solid #28a745;
    }
    .summary-card.fail {
      background: #f8d7da;
      border: 2px solid #dc3545;
    }
    .summary-card.warning {
      background: #fff3cd;
      border: 2px solid #ffc107;
    }
    .score-circle {
      font-size: 3rem;
      font-weight: bold;
      margin: 10px 0;
    }
    .btn-run {
      background: #0071c5;
      color: white;
      border: none;
      padding: 12px 30px;
      font-size: 1.1rem;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.3s;
    }
    .btn-run:hover {
      background: #0054a6;
      transform: translateY(-2px);
    }
  </style>
</head>
<body>
  <div class="checker-container">
    <h1 class="mb-4">
      <i class="bi bi-shield-check"></i> Accessibility Checker
    </h1>
    <p class="lead">This tool checks the Intel Sustainability Timeline page for accessibility compliance.</p>
    
    <div class="text-center my-4">
      <button class="btn-run" onclick="runAccessibilityCheck()">
        <i class="bi bi-play-circle"></i> Run Accessibility Check
      </button>
    </div>

    <div id="summary" style="display: none;">
      <h2 class="mt-4 mb-3">Summary</h2>
      <div class="summary">
        <div class="summary-card pass">
          <i class="bi bi-check-circle icon-check"></i>
          <div class="score-circle" id="passCount">0</div>
          <div>Passed</div>
        </div>
        <div class="summary-card warning">
          <i class="bi bi-exclamation-triangle icon-warning"></i>
          <div class="score-circle" id="warningCount">0</div>
          <div>Warnings</div>
        </div>
        <div class="summary-card fail">
          <i class="bi bi-x-circle icon-fail"></i>
          <div class="score-circle" id="failCount">0</div>
          <div>Failed</div>
        </div>
      </div>
      
      <div class="mt-3 p-3 bg-light rounded">
        <h3 class="h5">Overall Score</h3>
        <div class="progress" style="height: 30px;">
          <div id="scoreBar" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">0%</div>
        </div>
      </div>
    </div>

    <div id="results" class="mt-4">
      <h2>Test Results</h2>
      <div id="checkList"></div>
    </div>
  </div>

  <script>
    async function runAccessibilityCheck() {
      const results = [];
      
      // Fetch the main page
      const response = await fetch('index.html');
      const html = await response.text();
      const parser = new DOMParser();
      const doc = parser.parseFromString(html, 'text/html');
      
      // Test 1: Check for skip link
      const skipLink = doc.querySelector('a[href="#main-content"]');
      results.push({
        name: 'Skip Navigation Link',
        description: 'Provides keyboard users quick access to main content',
        status: skipLink ? 'pass' : 'fail'
      });
      
      // Test 2: Check for semantic HTML
      const hasHeader = doc.querySelector('header');
      const hasMain = doc.querySelector('main');
      results.push({
        name: 'Semantic HTML Structure',
        description: 'Uses proper HTML5 semantic elements',
        status: (hasHeader && hasMain) ? 'pass' : 'fail'
      });
      
      // Test 3: Check all images have alt text
      const images = doc.querySelectorAll('img');
      const imagesWithAlt = Array.from(images).filter(img => img.hasAttribute('alt'));
      results.push({
        name: 'Image Alt Text',
        description: `${imagesWithAlt.length} of ${images.length} images have alt text`,
        status: imagesWithAlt.length === images.length ? 'pass' : 'fail'
      });
      
      // Test 4: Check for heading hierarchy
      const h1 = doc.querySelectorAll('h1');
      results.push({
        name: 'Heading Hierarchy',
        description: `Page has ${h1.length} H1 heading${h1.length !== 1 ? 's' : ''}`,
        status: h1.length === 1 ? 'pass' : 'warning'
      });
      
      // Test 5: Check for ARIA labels
      const ariaLabels = doc.querySelectorAll('[aria-label], [aria-labelledby]');
      results.push({
        name: 'ARIA Labels',
        description: `Found ${ariaLabels.length} elements with ARIA labels`,
        status: ariaLabels.length > 0 ? 'pass' : 'warning'
      });
      
      // Test 6: Check for lang attribute
      const hasLang = doc.documentElement.hasAttribute('lang');
      results.push({
        name: 'Language Attribute',
        description: 'HTML element has lang attribute',
        status: hasLang ? 'pass' : 'fail'
      });
      
      // Test 7: Check for RTL support
      const hasDir = doc.documentElement.hasAttribute('dir');
      results.push({
        name: 'RTL Direction Support',
        description: 'HTML element has dir attribute for RTL support',
        status: hasDir ? 'pass' : 'warning'
      });
      
      // Test 8: Check for viewport meta tag
      const viewport = doc.querySelector('meta[name="viewport"]');
      results.push({
        name: 'Responsive Viewport',
        description: 'Has viewport meta tag for mobile devices',
        status: viewport ? 'pass' : 'fail'
      });
      
      // Test 9: Check for form labels
      const inputs = doc.querySelectorAll('input, select, textarea');
      const inputsWithLabels = Array.from(inputs).filter(input => {
        const id = input.id;
        return id && doc.querySelector(`label[for="${id}"]`);
      });
      results.push({
        name: 'Form Labels',
        description: `${inputsWithLabels.length} of ${inputs.length} form controls have labels`,
        status: inputs.length === 0 || inputsWithLabels.length === inputs.length ? 'pass' : 'warning'
      });
      
      // Test 10: Check for meta description
      const metaDesc = doc.querySelector('meta[name="description"]');
      results.push({
        name: 'Meta Description',
        description: 'Page has meta description for SEO',
        status: metaDesc ? 'pass' : 'warning'
      });
      
      // Test 11: Check for title
      const hasTitle = doc.querySelector('title') && doc.querySelector('title').textContent.trim() !== '';
      results.push({
        name: 'Page Title',
        description: 'Page has a descriptive title',
        status: hasTitle ? 'pass' : 'fail'
      });
      
      // Test 12: Check for language detector script
      const jsScripts = doc.querySelectorAll('script[src]');
      const hasLangDetector = Array.from(jsScripts).some(script => 
        script.src.includes('language-detector')
      );
      results.push({
        name: 'Language Detection Script',
        description: 'Has script for automatic RTL/LTR detection',
        status: hasLangDetector ? 'pass' : 'warning'
      });
      
      // Display results
      displayResults(results);
    }
    
    function displayResults(results) {
      const checkList = document.getElementById('checkList');
      const summary = document.getElementById('summary');
      
      checkList.innerHTML = '';
      
      let passCount = 0;
      let failCount = 0;
      let warningCount = 0;
      
      results.forEach(result => {
        const div = document.createElement('div');
        div.className = `check-item ${result.status}`;
        
        let icon = '';
        if (result.status === 'pass') {
          icon = '<i class="bi bi-check-circle icon-check"></i>';
          passCount++;
        } else if (result.status === 'fail') {
          icon = '<i class="bi bi-x-circle icon-fail"></i>';
          failCount++;
        } else {
          icon = '<i class="bi bi-exclamation-triangle icon-warning"></i>';
          warningCount++;
        }
        
        div.innerHTML = `
          ${icon}
          <div style="flex: 1;">
            <strong>${result.name}</strong>
            <div style="font-size: 0.9rem; color: #666;">${result.description}</div>
          </div>
        `;
        
        checkList.appendChild(div);
      });
      
      // Update summary
      document.getElementById('passCount').textContent = passCount;
      document.getElementById('failCount').textContent = failCount;
      document.getElementById('warningCount').textContent = warningCount;
      
      // Calculate score (pass = 1 point, warning = 0.5, fail = 0)
      const totalTests = results.length;
      const score = Math.round(((passCount + warningCount * 0.5) / totalTests) * 100);
      
      const scoreBar = document.getElementById('scoreBar');
      scoreBar.style.width = score + '%';
      scoreBar.textContent = score + '%';
      scoreBar.setAttribute('aria-valuenow', score);
      
      // Color code the score bar
      if (score >= 90) {
        scoreBar.className = 'progress-bar bg-success';
      } else if (score >= 70) {
        scoreBar.className = 'progress-bar bg-warning';
      } else {
        scoreBar.className = 'progress-bar bg-danger';
      }
      
      summary.style.display = 'block';
      
      // Scroll to results
      document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
    }
  </script>
</body>
</html>
